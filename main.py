import streamlit as st
from deta import Deta
import time

deta = Deta(st.secrets["deta_key"])
Global = deta.Base("Global")
db = deta.Base('Kitay')
Attak_Kitay = deta.Base('Attak_Kitay')
Graph = deta.Base('Photo_Url')
request = deta.Base('request')
request_money = deta.Base('request_money')

city = Global.get('Kitay')

Global.put({'money': '1000', 'sunks_of_you': '0', 'sunks_for_you': '0', 'roket': '0', 'shit1': '0', 'shit2': '0',
          'shit3': '0', 'shit4': '0', 'up1': '0', 'up2': '0', 'up3': '0', 'up4': '0', 'debaf1': '0', 'debaf2': '0',
          'debaf3': '0', 'debaf4': '0'})

db_content = Attak_Kitay.fetch().items
st.write(db_content)

money = city['money'] - ((city['sunks_of_you'] * 50) + (city['sunks_for_you'] * 100))
st.set_page_config(

    page_title="–ú–∏—Ä–æ–≤–æ–µ –≥–æ—Å–ø–æ–¥—Å—Ç–≤–æ",
    page_icon="ü•≠",
    layout="wide",
    initial_sidebar_state="collapsed",  # expanded/collapsed
    menu_items={
        'Get Help': 'https://www.youtube.com/watch?v=dQw4w9WgXcQ',
        'Report a bug': "https://www.youtube.com/watch?v=dQw4w9WgXcQ",
        'About': "# –ê–≤—Ç–æ—Ä MangoVirus"
    })
st.sidebar.image('https://cdn.discordapp.com/attachments/890188503047077928/1070451124869533758/066443762463369c.png',
                 width=64)
menu = st.sidebar.selectbox('–ú–µ–Ω—é',
                            ('–°—Ç–∞—Ä—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞', '–£–ª—É—á—à–µ–Ω–∏—è', '–†–∞–∫–µ—Ç–∞', '–ü–æ—Å–µ—â–µ–Ω–∏—è', '–ì—É–º–∞–Ω–∏—Ç–∞—Ä–Ω–∞—è –ø–æ–º–æ—â—å', '–ê–≤—Ç–æ—Ä—ã'))

masiv_up = [0, 0, 0, 0]
masiv_shit = [' ', ' ', ' ', ' ']
attak = []
attak1 = []
attak2 = []
attak3 = []
attak4 = []

if menu == '–ê–≤—Ç–æ—Ä—ã':
    '''# –ù–∞–¥ –¥–∞–Ω–Ω—ã–º –ø—Ä–æ–µ–∫—Ç–æ–º —Ä–∞–±–æ—Ç–∞–ª–∏'''
    st.subheader('MangoVirus')
    '''–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ —Å–∞–π—Ç–∞, —Å–æ–∑–¥–∞—Ç–µ–ª—å DataBase.'''
    st.subheader('–¢—É—Ä–±–∞')
    '''–ü—Ä–æ–µ–∫—Ç–Ω—ã–π —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å, –¥–∏–∑–∞–π–Ω–µ—Ä.'''
    st.subheader(
        '–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å –Ω–∞—Å –∏ –≤ –±—É–¥—É—â–µ–º –≤–∏–¥–µ—Ç—å –±–æ–ª–µ–µ –º–∞—à—Ç–∞–±–Ω—ã–µ –Ω–æ–≤–æ–≤–µ–¥–µ–Ω–∏—è –≤—ã '
        '–º–æ–∂–µ—Ç–µ —Å–∫–∏–Ω—É—Ç—å –Ω–∞–º –ø–∞—Ä—É —Ç—É–≥—Ä–∏–∫–æ–≤ –ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞ 8(977)382-41-17')

if menu == '–ì—É–º–∞–Ω–∏—Ç–∞—Ä–Ω–∞—è –ø–æ–º–æ—â—å':
    st.write('–î–µ–Ω—å–≥–∏:', money)
    visit_money = st.selectbox('–ö–æ–º—É –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –¥–µ–Ω—å–≥–∏?',
                               ('–Ø–ø–æ–Ω–∏—è', '–°–µ–≤–µ—Ä–Ω–∞—è –ö–æ—Ä–µ—è', '–ü–∞–∫–∏—Å—Ç–∞–Ω', '–ê—Ñ–≥–∞–Ω–∏—Å—Ç–∞–Ω', '–°–∏—Ä–∏—è'))
    how_money = st.number_input('–°—É–º–º–∞ –ø–µ—Ä–µ–≤–æ–¥–∞?', 0)
    if st.button('–ü–µ—Ä–µ–≤–µ—Å—Ç–∏'):
        request_money.put({'who': 'Kitay', 'come': visit_money, 'price': how_money})
        st.success('–ó–∞–ø—Ä–æ—Å –Ω–∞ –ø–µ—Ä–µ–≤–æ–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω.(–î–µ–Ω—å–≥–∏ –ø—Ä–∏–¥—É—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ 5 –º–∏–Ω—É—Ç)')

if menu == '–ü–æ—Å–µ—â–µ–Ω–∏—è':
    visit = st.selectbox('–ö–∞–∫—É—é —Å—Ç–∞—Ä–∞–Ω—É –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø–æ—Å–µ—Ç–∏—Ç—å?',
                         ('–Ø–ø–æ–Ω–∏—è', '–°–µ–≤–µ—Ä–Ω–∞—è –ö–æ—Ä–µ—è', '–ü–∞–∫–∏—Å—Ç–∞–Ω', '–ê—Ñ–≥–∞–Ω–∏—Å—Ç–∞–Ω', '–°–∏—Ä–∏—è'))
    if st.button('–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å'):
        request.put({'who': 'Kitay', 'come': visit})
        st.success('–ó–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ—Å–µ—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω')

if menu == '–†–∞–∫–µ—Ç–∞':
    final_roket = -1
    st.write('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∞—à–∏—Ö —Ä–∞–∫–µ—Ç:', city['roket'])

    country = st.multiselect('–ö–∞–∫–∏–µ —Å—Ç—Ä–∞–Ω—ã –∞—Ç–∞–∫—É–µ–º?', ['–Ø–ø–æ–Ω–∏—è', '–°–µ–≤–µ—Ä–Ω–∞—è –ö–æ—Ä–µ—è', '–ü–∞–∫–∏—Å—Ç–∞–Ω', '–ê—Ñ–≥–∞–Ω–∏—Å—Ç–∞–Ω', '–°–∏—Ä–∏—è'])
    attak_dict = dict.fromkeys(['–Ø–ø–æ–Ω–∏—è', '–°–µ–≤–µ—Ä–Ω–∞—è –ö–æ—Ä–µ—è', '–ü–∞–∫–∏—Å—Ç–∞–Ω', '–ê—Ñ–≥–∞–Ω–∏—Å—Ç–∞–Ω', '–°–∏—Ä–∏—è'], [])

    for i in range(0, len(country)):
        if country[i] == '–Ø–ø–æ–Ω–∏—è':
            attak_dict['–Ø–ø–æ–Ω–∏—è'] = st.multiselect('–ö–∞–∫–∏–µ –≥–æ—Ä–æ–¥–∞ –∞—Ç–∞–∫—É–µ–º –≤ –Ø–ø–æ–Ω–∏–∏?',
                                                  ['–ô–æ–∫–æ–≥–∞–º–∞', '–¢–æ–∫–∏–æ', '–ö–∏–æ—Ç–æ', '–û—Å–∞–∫–∞', ])
        if country[i] == '–°–µ–≤–µ—Ä–Ω–∞—è –ö–æ—Ä–µ—è':
            attak_dict['–°–µ–≤–µ—Ä–Ω–∞—è –ö–æ—Ä–µ—è'] = st.multiselect('–ö–∞–∫–∏–µ –≥–æ—Ä–æ–¥–∞ –∞—Ç–∞–∫—É–µ–º –≤ –°–µ–≤–µ—Ä–Ω–æ–π-–ö–æ—Ä–µ–µ?',
                                                          ['–ü—Ö–µ–Ω—å—è–Ω', '–†–∞—Å–æ–Ω', '–•—É—Å–∞–Ω', '–í–æ–Ω—Å–∞–Ω', ])
        if country[i] == '–ü–∞–∫–∏—Å—Ç–∞–Ω':
            attak_dict['–ü–∞–∫–∏—Å—Ç–∞–Ω'] = st.multiselect('–ö–∞–∫–∏–µ –≥–æ—Ä–æ–¥–∞ –∞—Ç–∞–∫—É–µ–º –≤ –ü–∞–∫–∏—Å—Ç–∞–Ω–µ?',
                                                    ['–ö–∞—Ä–∞—á–∏', '–õ–∞—Ö–æ—Ä', '–ú—É–ª—Ç–∞–Ω', '–ö–≤–µ—Ç—Ç–∞', ])
        if country[i] == '–ê—Ñ–≥–∞–Ω–∏—Å—Ç–∞–Ω':
            attak_dict['–ê—Ñ–≥–∞–Ω–∏—Å—Ç–∞–Ω'] = st.multiselect('–ö–∞–∫–∏–µ –≥–æ—Ä–æ–¥–∞ –∞—Ç–∞–∫—É–µ–º –≤ –ê—Ñ–≥–∞–Ω–∏—Å—Ç–∞–Ω–µ?',
                                                      ['–ö–∞–±—É–ª', '–ì–µ—Ä–∞—Ç', '–ö–∞–Ω–¥–∞–≥–∞—Ä', '–ö—É–Ω–¥—É–∑', ])
        if country[i] == '–°–∏—Ä–∏—è':
            attak_dict['–°–∏—Ä–∏—è'] = st.multiselect('–ö–∞–∫–∏–µ –≥–æ—Ä–æ–¥–∞ –∞—Ç–∞–∫—É–µ–º –≤ –°–∏—Ä–∏–∏?',
                                                 ['–ê–ª–ª–µ–ø–æ', '–î–∞–º–∞—Å–∫', '–•–∞–º–∞', '–ê—Ñ—Ä–∏–Ω', ])
        final_roket = city['roket'] - (sum(list(map(len, attak_dict.values()))))
        st.write('–£ –≤–∞—Å –æ—Å—Ç–∞–Ω–µ—Ç—å—Å—è —Ä–∞–∫–µ—Ç:', final_roket)

    if st.button('–û—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ'):
        if final_roket >= 0:
            Attak_Kitay.put({'–Ø–ø–æ–Ω–∏—è': str(attak_dict['–Ø–ø–æ–Ω–∏—è']),
                             '–°–µ–≤–µ—Ä–Ω–∞—è –ö–æ—Ä–µ—è': str(attak_dict['–°–µ–≤–µ—Ä–Ω–∞—è –ö–æ—Ä–µ—è']),
                             '–ü–∞–∫–∏—Å—Ç–∞–Ω': str(attak_dict['–ü–∞–∫–∏—Å—Ç–∞–Ω']),
                             '–ê—Ñ–≥–∞–Ω–∏—Å—Ç–∞–Ω': str(attak_dict['–ê—Ñ–≥–∞–Ω–∏—Å—Ç–∞–Ω']),
                             '–°–∏—Ä–∏—è': str(attak_dict['–°–∏—Ä–∏—è'])
                             })
            db_content = Attak_Kitay.fetch().items
            st.write(db_content)
            with st.spinner('Wait for it...'):
                time.sleep(1)
            st.success('–î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã!')
        else:
            st.error('–í—ã –≤—ã–ø—É—Å—Ç–∏–ª–∏ –±–æ–ª—å—à–µ —Ä–∞–∫–µ—Ç —á–µ–º —É –≤–∞—Å –µ—Å—Ç—å...')

if menu == '–£–ª—É—á—à–µ–Ω–∏—è':
    time1 = 0
    st.write('–î–µ–Ω—å–≥–∏:', money)

    st.write('–ö–∞–∫–∏–µ –≥–æ—Ä–æ–¥–∞ –≤—ã —Ö–æ—Ç–∏—Ç–µ —É–ª—É—á—à–∏—Ç—å?')
    up = st.checkbox('–ü–µ–∫–∏–Ω')
    if up:
        masiv_up[0] += 1
        money -= 200
    up1 = st.checkbox('–®–∞–Ω—Ö–∞–π')
    if up1:
        masiv_up[1] += 1
        money -= 200
    up2 = st.checkbox('–ì—É–∞–Ω—á–∂–æ—É')
    if up2:
        masiv_up[2] += 1
        money -= 200
    up3 = st.checkbox('–ì–æ–Ω–∫–æ–Ω–≥')
    if up3:
        masiv_up[3] += 1
        money -= 200

    st.write('–ù–∞ –∫–∞–∫–∏–µ –≥–æ—Ä–æ–¥–∞ —É—Å—Ç–∞–Ω–æ–≤–∏–º —â–∏—Ç—ã?')
    shit = st.checkbox('–ü–µ–∫–∏–Ω ')
    if shit:
        masiv_shit[0] += 'üõ°Ô∏è'
        money -= 400
    shit1 = st.checkbox('–®–∞–Ω—Ö–∞–π ')
    if shit1:
        masiv_shit[1] += 'üõ°Ô∏è'
        money -= 400
    shit2 = st.checkbox('–ì—É–∞–Ω—á–∂–æ—É ')
    if shit2:
        masiv_shit[2] += 'üõ°Ô∏è'
        money -= 400
    shit3 = st.checkbox('–ì–æ–Ω–∫–æ–Ω–≥ ')
    if shit3:
        masiv_shit[3] += 'üõ°Ô∏è'
        money -= 400

    number = st.number_input('–°–∫–æ–ª—å–∫–æ —Ä–∞–∫–µ—Ç –¥–µ–ª–∞–µ–º?', 0)
    st.write('–í—ã –ø–æ–ª—É—á–∏—Ç–µ –≤ —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–∫–µ—Ç', number)
    money -= 500 * number

    sunks_for_who = st.multiselect('–ù–∞ –∫–∞–∫–∏–µ —Å—Ç—Ä–∞–Ω—ã –≤—ã —Ö–æ—Ç–∏—Ç–µ –Ω–∞–ª–æ–∂–∏—Ç—å —Å–∞–Ω–∫—Ü–∏–∏?',
                                   ['–Ø–ø–æ–Ω–∏—è', '–°–µ–≤–µ—Ä–Ω–∞—è –ö–æ—Ä–µ—è', '–ü–∞–∫–∏—Å—Ç–∞–Ω', '–ê—Ñ–≥–∞–Ω–∏—Å—Ç–∞–Ω', '–°–∏—Ä–∏—è'])
    money -= 50 * len(sunks_for_who)

    st.write('–í–∞—à –±–∞–ª–∞–Ω—Å –ø–æ—Å–ª–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:', money)

    col1, col2, col3, col4 = st.columns(4)
    col1.metric('üè†' + city['shit1'] + masiv_shit[0] + '–ü–µ–∫–∏–Ω',
                '‚öôÔ∏è' + str(60 + 10 * city['up1'] + 10 * masiv_up[0]) + '%' + ' üå≥ ' + str(
                    72 + (10 * city['up1'] + 10 * masiv_up[0]) - (city['debaf1'] * 20)) + '%', masiv_up[0] * 10)
    col2.metric('üè†' + city['shit2'] + masiv_shit[1] + '–®–∞–Ω—Ö–∞–π',
                '‚öôÔ∏è' + str(50 + 10 * city['up2'] + 10 * masiv_up[1]) + '%' + ' üå≥ ' + str(
                    54 + (10 * city['up2'] + 10 * masiv_up[1]) - - (city['debaf2'] * 20)) + '%', masiv_up[1] * 10)
    col3.metric('üè†' + city['shit3'] + masiv_shit[2] + '–ì—É–∞–Ω—á–∂–æ—É',
                '‚öôÔ∏è' + str(50 + 10 * city['up3'] + 10 * masiv_up[2]) + '%' + ' üå≥ ' + str(
                    54 + (10 * city['up3'] + 10 * masiv_up[2]) - (city['debaf3'] * 20)) + '%', masiv_up[2] * 10)
    col4.metric('üè†' + city['shit4'] + masiv_shit[3] + '–ì–æ–Ω–∫–æ–Ω–≥',
                '‚öôÔ∏è' + str(40 + 10 * city['up4'] + 10 * masiv_up[3]) + '%' + ' üå≥ ' + str(
                    36 + (10 * city['up4'] + 10 * masiv_up[3]) - (city['debaf4'] * 20)) + '%', masiv_up[3] * 10)

    if st.button('–û—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ'):
        if money >= 0:
            db.put({"money": money, "roket": number, "shit": str(masiv_shit), "up": str(masiv_up),
                    'sunks_for_who': str(sunks_for_who)})
            db_content = db.fetch().items
            st.write(db_content)
            with st.spinner('Wait for it...'):
                time.sleep(1)
            st.success('–î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã!')
        else:
            st.error('–í—ã –ø–æ—Ç—Ä–∞—Ç–∏–ª–∏ –±–æ–ª—å—à–µ –¥–µ–Ω–µ–≥ —á–µ–º —É –≤–∞—Å –µ—Å—Ç—å...')

if menu == '–°—Ç–∞—Ä—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞':
    st.title('–í—ã –∏–≥—Ä–∞–µ—Ç–µ –∑–∞ –ö–∏—Ç–∞–π')

    st.write('–î–µ–Ω—å–≥–∏:', money)
    st.write('–†–∞–∫–µ—Ç—ã:', city['roket'])
    st.write('–°–∞–Ω–∫—Ü–∏–∏ –Ω–∞–ª–æ–∂–µ–Ω—ã–µ –≤–∞–º–∏:', city['sunks_of_you'])
    st.write('–°–∞–Ω–∫—Ü–∏–∏ –Ω–∞–ª–æ–∂–µ–Ω—ã–µ –Ω–∞ –≤–∞—Å:', city['sunks_for_you'])
    col1, col2, col3, col4 = st.columns(4)
    col1.metric('üè†' + city['shit1'] + '–ü–µ–∫–∏–Ω', '‚öôÔ∏è' + str(60 + 10 * city['up1']) + '%' + ' üå≥ ' + str(
        72 + 10 * city['up1'] - (city['debaf1'] * 20)) + '%')
    col2.metric('üè†' + city['shit2'] + '–®–∞–Ω—Ö–∞–π', '‚öôÔ∏è' + str(50 + 10 * city['up2']) + '%' + ' üå≥ ' + str(
        54 + 10 * city['up2'] - (city['debaf2'] * 20)) + '%')
    col3.metric('üè†' + city['shit3'] + '–ì—É–∞–Ω—á–∂–æ—É', '‚öôÔ∏è' + str(50 + 10 * city['up3']) + '%' + ' üå≥ ' + str(
        54 + 10 * city['up3'] - (city['debaf3'] * 20)) + '%')
    col4.metric('üè†' + city['shit4'] + '–ì–æ–Ω–∫–æ–Ω–≥', '‚öôÔ∏è' + str(40 + 10 * city['up4']) + '%' + ' üå≥ ' + str(
        36 + 10 * city['up4'] - (city['debaf4'] * 20)) + '%')
    photo = deta.Base('Photo_Url')
    pp = photo.get('bb6a5172diyj')
    st.image(pp['Graph1'])
    st.image(pp['Graph2'])
    st.image(pp['Graph3'])
    st.image(pp['Graph4'])
    st.caption('–ê–≤—Ç–æ—Ä MangoVirus')
